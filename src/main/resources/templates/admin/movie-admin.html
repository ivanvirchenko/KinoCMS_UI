<!DOCTYPE html>

<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<div th:include="~{/share/admin-header :: admin-head}"></div>
<body class="hold-transition sidebar-mini">
<div class="wrapper">

    <div th:include="~{/share/admin-sidebar :: admin-sidebar}"></div>

    <div class="content-wrapper p-5">

        <form id="object_form" action="#" th:action="@{/admin/movies/update}" enctype="multipart/form-data"
              method="post" th:object="${movie_from_db}">

            <input type="hidden" th:value="*{id}" th:field="*{id}">

            <div class="row">
                <div class="col-3">
                    <img src="#" alt="#" th:src="*{image.url}">
                    <div class="d-flex">
                        <input type="file" hidden id="main_image_input" name="main_image">
                        <label for="main_image_input" class="btn btn-outline-primary w-50 m-0">Загрузить</label>
                        <input form="delete_image" type="submit" class="btn btn-outline-danger w-50" value="Удалить">
                        <input form="delete_image" type="hidden" name="main_image" th:value="*{image.name}">
                        <input form="delete_image" type="hidden" name="movie_id" th:value="*{id}">
                    </div>
                </div>

                <div class="col-9">
                    <div class="d-flex align-items-end">
                        <div class="col-3">
                            <label for="movie_name">Название</label>
                            <input id="movie_name" type="text" th:field="*{name}" class="form-control">
                        </div>

                        <div class="col-3">
                            <label for="start_date">Дата начала</label>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="far fa-calendar-alt"></i></span>
                                </div>
                                <input th:field="*{startDate}" id="start_date" type="text" class="form-control"
                                       data-inputmask-alias="datetime" data-inputmask-inputformat="dd/mm/yyyy"
                                       data-mask="" im-insert="false">
                            </div>
                        </div>

                        <div class="col-3">
                            <label for="end_date">Дата окончания</label>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="far fa-calendar-alt"></i></span>
                                </div>
                                <input th:field="*{endDate}" id="end_date" type="text" class="form-control"
                                       data-inputmask-alias="datetime" data-inputmask-inputformat="dd/mm/yyyy"
                                       data-mask="" im-insert="false">
                            </div>
                        </div>

                        <div class="col-3">
                            <input form="delete_form" type="submit" class="btn btn-danger w-100" value="Удалить фильм">
                            <input form="delete_form" type="hidden" name="movie_id" th:value="*{id}">
                            <input type="submit" class="btn btn-success w-100 mt-3" value="Сохранить">
                        </div>

                    </div>
                    <div class="col-9">
                        <label for="description_area" class="mt-4">Описание</label>
                        <textarea id="description_area" rows="8" class="form-control"
                                  th:field="*{description}"></textarea>
                        <label for="videoLink" class="mt-4">Ссылка на трейлер</label>
                        <input id="videoLink" type="text" th:field="*{videoLink}" class="form-control">

                        <div class="types mt-4">
                            <label>Типы показов</label>
                            <div class="movie_types d-flex">
                                <div class="type mr-3" th:each="t : ${all_types}">
                                    <input type="checkbox" class="mr-1"
                                           th:text="${t.type}"
                                           th:value="${t}"
                                           th:field="*{types}"
                                    >
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <div class="mt-3 col-10 p-0">
                <label class="bg-blue p-3 text-lg">Галерея изображений</label>
                <div class="gallery grid">
                    <div class="image" th:each="im : *{gallery}">
                        <img src="#" th:src="${im.url}">
                    </div>

                    <input id="files_input" type="file" name="image_gallery" multiple hidden>

                    <div id="upload_btn" class="w-100 h-100 border rounded border-primary d-flex align-items-center justify-content-center">
                        Загрузить еще
                    </div>
                </div>
            </div>

            <div class="col-10 p-0 mt-2 elevation-2">
                <div class="seo_block bg-blue p-3 text-lg">
                    Блок SEO
                </div>
                <div class="div info p-2">
                    <label>
                        URL
                        <input type="text" th:field="*{seo.url}" class="form-control">
                    </label>
                    <label>
                        Заголовок
                        <input type="text" th:field="*{seo.title}" class="form-control">
                    </label>
                    <label>
                        Ключевые слова
                        <input type="text" th:field="*{seo.keyWords}" class="form-control">
                    </label>
                    <label>
                        Описание
                        <input type="text" th:field="*{seo.description}" class="form-control">
                    </label>
                </div>
            </div>
        </form>

        <!--Main image delete-->
        <form id="delete_image" method="post" th:action="@{/admin/movies/file/delete}"></form>
        <form id="delete_form" method="post" th:action="@{/admin/movies/delete}"></form>
    </div>

</div>
<div th:include="~{/share/admin-scripts :: admin-scripts}"></div>
</body>
</html>
